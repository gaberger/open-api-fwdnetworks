defmodule FwdClient.Vulnerability do
  @moduledoc """
  Provides struct and type for a Vulnerability
  """

  @type t :: %__MODULE__{
          description: String.t() | nil,
          detectionMethod: String.t(),
          devices: [String.t()],
          id: String.t(),
          os: String.t(),
          osVersions: [String.t()],
          relevantLineRanges: map,
          severity: String.t(),
          url: String.t() | nil,
          vendor: String.t()
        }

  defstruct [
    :description,
    :detectionMethod,
    :devices,
    :id,
    :os,
    :osVersions,
    :relevantLineRanges,
    :severity,
    :url,
    :vendor
  ]

  @doc false
  @spec __fields__(atom) :: keyword
  def __fields__(type \\ :t)

  def __fields__(:t) do
    [
      description: {:string, :generic},
      detectionMethod: {:enum, ["OS_VERSION", "CONFIG"]},
      devices: [string: :generic],
      id: {:string, :generic},
      os:
        {:enum,
         [
           "unknown",
           "circuit",
           "l2_vpn_service",
           "missing_peer",
           "mpls_vpn_service",
           "internet_service",
           "intranet_service",
           "encryptor",
           "arista_eos",
           "avi_vantage",
           "bluecoat",
           "cisco_ios",
           "cisco_ios_xe",
           "cisco_ios_xr",
           "cisco_nxos",
           "cisco_asa",
           "cisco_ftd",
           "cisco_nxos_aci",
           "cisco_apic",
           "cisco_sg",
           "viptela",
           "viptela_smart",
           "juniper_junos",
           "juniper_srx",
           "juniper_netscreen",
           "linux_ovs_ofctl",
           "linux_os",
           "pica8_ovs_ofctl",
           "openflow_ovs",
           "f5",
           "a10_acos",
           "checkpoint",
           "hp_provision",
           "hp_comware",
           "fortinet",
           "pan_os",
           "esxi",
           "citrix_netscaler",
           "cumulus",
           "riverbed_steelhead",
           "riverbed_interceptor",
           "128t",
           "aruba_switch",
           "aruba_wifi_controller",
           "silver_peak_edgeconnect",
           "pensando",
           "cloud_genix",
           "forcepoint",
           "aws_cloud",
           "aws_subnet",
           "aws_rt",
           "aws_internet_gw",
           "aws_nat_gw",
           "aws_vpn_gw",
           "aws_direct_connect_gw",
           "aws_lb",
           "aws_global_accelerator",
           "aws_transit_gw",
           "aws_network_firewall",
           "aws_gateway_lb",
           "aws_service_endpoint",
           "nsx",
           "vcenter_api",
           "azure_cloud",
           "azure_subnet",
           "azure_vnet",
           "azure_vnet_gw",
           "azure_firewall",
           "azure_app_gw",
           "azure_lb",
           "azure_vwan_hub",
           "azure_vpn_gateway",
           "azure_p2s_vpn_gateway",
           "azure_express_route_gateway",
           "azure_virtual_appliance",
           "azure_express_route_circuit",
           "google_cloud",
           "gcp_rt",
           "gcp_subnet",
           "gcp_lb",
           "gcp_traffic_director",
           "gcp_vpn_gw",
           "gcp_nat_gw",
           "gcp_service_attachment",
           "avaya",
           "viasat_encryptor",
           "bluecat",
           "nokia",
           "versa_sase",
           "brocade_switch",
           "extreme_nos"
         ]},
      osVersions: [string: :generic],
      relevantLineRanges: :map,
      severity: {:enum, ["NONE", "LOW", "MEDIUM", "HIGH", "CRITICAL"]},
      url: {:string, :generic},
      vendor:
        {:enum,
         [
           "UNKNOWN",
           "CISCO",
           "JUNIPER",
           "ARISTA",
           "PICA8",
           "F5",
           "A10",
           "CHECKPOINT",
           "HP",
           "FORTINET",
           "PALO_ALTO_NETWORKS",
           "VMWARE",
           "CITRIX",
           "CUMULUS",
           "RIVERBED",
           "OPENFLOW_GENERIC",
           "LINUX_GENERIC",
           "AMAZON",
           "SYMANTEC",
           "AVI_NETWORKS",
           "MICROSOFT",
           "GOOGLE",
           "AVAYA",
           "T128",
           "ARUBA",
           "VIASAT",
           "SILVER_PEAK",
           "PENSANDO",
           "FORCEPOINT",
           "BLUECAT",
           "NOKIA",
           "VERSA",
           "BROCADE",
           "EXTREME",
           "FORWARD_CUSTOM"
         ]}
    ]
  end
end
