defmodule FwdClient.VulnerabilityAnalysis do
  @moduledoc """
  Provides API endpoint related to vulnerability analysis
  """
  use FwdClient.Encoder

  @default_client FwdClient.Client

  @doc """
  Gets vulnerabilities and possibly impacted devices
  """
  @spec get_vulnerabilities_using_get(String.t(), keyword) ::
          {:ok, map} | {:error, FwdClient.Error.t()}
  def get_vulnerabilities_using_get(snapshotId, opts \\ []) do
    client = opts[:client] || @default_client

    client.request(%{
      args: [snapshotId: snapshotId],
      call: {FwdClient.VulnerabilityAnalysis, :get_vulnerabilities_using_get},
      url: "/api/snapshots/#{snapshotId}/vulnerabilities",
      method: :get,
      response: [{200, :map}],
      opts: opts
    })
  end
end
